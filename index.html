<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<title>2025å¹´8æœˆã€‚æ¸…é‚&æ›¼è°·</title>
<style>
  body {
    -webkit-user-select: none;
    -webkit-touch-callout: none;
    touch-action: none; /* é˜²æ­¢é›™æŒ‡ç¸®æ”¾èˆ‡æ»‘å‹• */
  }
  #gameContainer {
    position: relative;
    width: 100vw;   /* è¦–çª—å¯¬åº¦ 100% */
    height: 100vh;  /* è¦–çª—é«˜åº¦ 100% */

    background-image: url('img/background1.png'), url('img/background2.png');
    background-repeat: no-repeat, no-repeat;
    background-position: 15% center, 85% center;
    background-size: 512px 512px, 512px 512px;

    background-color: #c5e3bf;
    overflow: hidden;
  }

  #hero {
    position: absolute;
    width: 50px;
    height: 50px;
    background-image: url('img/us.png');
    background-size: cover;    /* è®“åœ–ç‰‡å¡«æ»¿è§’è‰²å€å¡Š */
    background-position: center;
    border-radius: 50%;        /* å¯è¦–æƒ…æ³ä¿ç•™æˆ–åˆªé™¤ */
     z-index: 10;
  }
  .house {
    position: absolute;
    cursor: pointer;
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .house:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
  }
  .house img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .houseLabel {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 13px;
    font-weight: bold;
    color: #264d00;
    text-shadow: 0 1px 2px #fff;
    pointer-events: none;
  }
</style>
</head>
<body>
  <div id="gameContainer">
    <div id="hero"></div>
  </div>

  <script>
    const container = document.getElementById("gameContainer");
    const hero = document.getElementById("hero");

    let heroPos = { x: 120, y: 120 };
    const step = 6;
    const house = { id: "wat", x: 360, y: 200, w: 180, h: 130, name: "nightmarket" };

    const div = document.createElement("div");
    div.className = "house";
    div.style.left = house.x + "px";
    div.style.top = house.y + "px";
    div.style.width = house.w + "px";
    div.style.height = house.h + "px";
    div.innerHTML = `<div class='houseLabel'>${house.name}</div><img src='img/nightmarket.png' alt='nightmarket' />`;
    container.appendChild(div);

    function updateHero() {
      hero.style.left = heroPos.x + "px";
      hero.style.top = heroPos.y + "px";
    }
    updateHero();

    // ğŸ”¹ éµç›¤æ§åˆ¶
    const keys = {};
    document.addEventListener("keydown", e => keys[e.key] = true);
    document.addEventListener("keyup", e => keys[e.key] = false);

    // ğŸ”¹ æ‰‹æ©Ÿè§¸æ§æ§åˆ¶ï¼ˆé»æ“Šç§»å‹•ï¼‰
    let target = null;
    container.addEventListener("touchstart", e => {
      const rect = container.getBoundingClientRect();
      const touch = e.touches[0];
      target = {
        x: touch.clientX - rect.left - 25,
        y: touch.clientY - rect.top - 25
      };
    });

    // ğŸ”¹ æª¢æŸ¥ç¢°æ’
    function overlap(a, b) {
      return !(a.x + 40 < b.x || a.x > b.x + b.w || a.y + 40 < b.y || a.y > b.y + b.h);
    }

    function gameLoop() {
      let dx = 0, dy = 0;
      if (keys["ArrowUp"] || keys["w"]) dy -= step;
      if (keys["ArrowDown"] || keys["s"]) dy += step;
      if (keys["ArrowLeft"] || keys["a"]) dx -= step;
      if (keys["ArrowRight"] || keys["d"]) dx += step;

      // ğŸ”¹ æ‰‹æ©Ÿè§¸æ§ç§»å‹•
      if (target) {
        const diffX = target.x - heroPos.x;
        const diffY = target.y - heroPos.y;
        const dist = Math.hypot(diffX, diffY);
        if (dist > 5) {
          heroPos.x += (diffX / dist) * step;
          heroPos.y += (diffY / dist) * step;
        } else {
          target = null;
        }
      }

      heroPos.x = Math.max(0, Math.min(window.innerWidth - 60, heroPos.x + dx));
      heroPos.y = Math.max(0, Math.min(window.innerHeight - 60, heroPos.y + dy));
      updateHero();

      // ğŸ”¹ é€²å…¥æˆ¿é–“
      if ((keys["Enter"] || target === null) && overlap(heroPos, house)) {
        window.location.href = "album.html";
        keys["Enter"] = false;
        target = null;
      }

      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
