<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>清邁 ✈ 曼谷 冒險地圖</title>

<style>
body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
  text-align: center;
  color: white;
  font-family: "微軟正黑體";
}

/* === 地圖容器 === */
#map-container {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

/* === 地圖樣式 === */
.map {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: all 1s ease;
}

/* 曼谷縮小圖（右下角） */
.map.mini {
  width: 25vw;
  height: 25vw;
  bottom: 5vw;
  right: 5vw;
  border-radius: 10px;
  box-shadow: 0 0 10px #000;
  z-index: 2;
}

/* 目前顯示地圖 */
.map.active {
  z-index: 1;
}

/* === 玩家角色 === */
#player {
  position: absolute;
  width: 10vw;
  transition: all 0.2s linear;
  z-index: 3;
}

/* === 手機版控制鍵 === */
#controls {
  position: fixed;
  bottom: 5vh;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-wrap: wrap;
  width: 40vw;
  justify-content: center;
  gap: 1vw;
  z-index: 5;
}
#controls button {
  width: 10vw;
  height: 10vw;
  font-size: 5vw;
  border-radius: 50%;
  border: none;
  background: rgba(255,255,255,0.3);
  color: white;
  font-weight: bold;
}
</style>
</head>

<body>

<!-- === 地圖與角色 === -->
<div id="map-container">
  <img id="background1" src="img/chiangmai_map.png" class="map active" />
  <img id="background2" src="img/bangkok_map.png" class="map mini" />
  <img id="player" src="img/character.png" alt="player" />
</div>

<!-- === 控制鍵 === -->
<div id="controls" style="display: none;">
  <button id="up">↑</button>
  <button id="left">←</button>
  <button id="down">↓</button>
  <button id="right">→</button>
</div>

<script>
// 🟢 僅手機啟用地圖互動模式
if (/Mobi|Android/i.test(navigator.userAgent)) {
  const player = document.getElementById('player');
  const map1 = document.getElementById('background1');
  const map2 = document.getElementById('background2');
  const controls = document.getElementById('controls');

  controls.style.display = 'flex'; // 顯示控制鍵

  let x = 50; // 人物位置 (vw)
  let y = 50; // 人物位置 (vh)
  let currentMap = 1;
  let flying = false;

  function updatePosition() {
    player.style.left = x + 'vw';
    player.style.top = y + 'vh';
  }
  updatePosition();

  // === 控制移動 ===
  document.getElementById('up').onclick = () => move(0, -2);
  document.getElementById('down').onclick = () => move(0, 2);
  document.getElementById('left').onclick = () => move(-2, 0);
  document.getElementById('right').onclick = () => move(2, 0);

  function move(dx, dy) {
    if (flying) return;

    x += dx;
    y += dy;
    updatePosition();

    // 檢查是否走出清邁地圖範圍
    if (currentMap === 1 && (x < 0 || x > 100 || y < 0 || y > 100)) {
      flyToBangkok();
    }
  }

  // === 飛機動畫 + 地圖切換 ===
  function flyToBangkok() {
    flying = true;
    player.src = "img/airplane.png";
    player.style.transition = "all 2s ease-in-out";

    // 飛往右下角 (曼谷小圖位置)
    player.style.left = "75vw";
    player.style.top = "75vh";

    setTimeout(() => {
      // 清邁消失、曼谷放大
      map1.classList.remove("active");
      map2.classList.remove("mini");
      map2.classList.add("active");

      // 重置角色
      player.src = "img/character.png";
      player.style.transition = "none";
      x = 50; 
      y = 50;
      updatePosition();

      currentMap = 2;
      flying = false;
    }, 2000);
  }
}
</script>

</body>
</html>
